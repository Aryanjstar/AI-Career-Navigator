import{bs as y,bn as s,r as e,bC as Be}from"./vendor-B3bEaXca.js";import{s as Qe,R as N,G as Ve,V as Fe,u as Ne,L as Ge,S as Me,E as G,Q as qe,A as He,a as S,F as ze,b as $e,c as De,d as Ke,g as Je,e as We}from"./index-RMsKCvji.js";import{L as Xe}from"./fluentui-icons-BZpwZ7UB.js";import{u as Ye,i as Ze,b as et}from"./fluentui-react-BT-wSuVC.js";const tt="_askContainer_1rw8c_1",st="_askTopSection_1rw8c_8",nt="_askBottomSection_1rw8c_15",at="_askTitle_1rw8c_25",ot="_askQuestionInput_1rw8c_31",rt="_askAnswerContainer_1rw8c_37",it="_askAnalysisPanel_1rw8c_44",ut="_askSettingsSeparator_1rw8c_49",ct="_settingsButton_1rw8c_55",lt="_commandsContainer_1rw8c_61",gt="_commandButton_1rw8c_68",u={askContainer:tt,askTopSection:st,askBottomSection:nt,askTitle:at,askQuestionInput:ot,askAnswerContainer:rt,askAnalysisPanel:it,askSettingsSeparator:ut,settingsButton:ct,commandsContainer:lt,commandButton:gt},pt="_languagePicker_roq0j_1",mt="_languagePickerIcon_roq0j_22",M={languagePicker:pt,languagePickerIcon:mt},St=({onLanguageChange:c})=>{const{i18n:a}=y(),l=(r,o)=>{c(o?.data||a.language)},R=Ye("languagePicker"),{t:g}=y();return s.jsxs("div",{className:M.languagePicker,children:[s.jsx(Xe,{className:M.languagePickerIcon}),s.jsx(Ze,{id:R,selectedKey:a.language,options:Object.entries(Qe).map(([r,o])=>({key:r,text:o.name,selected:r===a.language,data:r})),onChange:l,ariaLabel:g("labels.languagePicker")})]})},dt="_twoColumnRoot_1lk21_1",ht="_leftColumn_1lk21_12",wt="_rightColumn_1lk21_24",x={twoColumnRoot:dt,leftColumn:ht,rightColumn:wt},_t=({left:c,right:a})=>s.jsxs("div",{className:x.twoColumnRoot,children:[s.jsx("div",{className:x.leftColumn,children:c}),s.jsx("div",{className:x.rightColumn,children:a})]});function ft(){const[c,a]=e.useState(!1),[l,R]=e.useState(""),[g,r]=e.useState(""),[o,kt]=e.useState(""),[q,Ct]=e.useState(.3),[A,vt]=e.useState(null),[H,xt]=e.useState(0),[z,yt]=e.useState(0),[$,D]=e.useState(N.Hybrid),[K,J]=e.useState(3),[W,Rt]=e.useState(10),[X,At]=e.useState("interleaved"),[Y,Z]=e.useState(!0),[ee,Tt]=e.useState(!1),[te,se]=e.useState(!1),[ne,ae]=e.useState(""),[d,Pt]=e.useState(!1),[oe,Ot]=e.useState(Ve.TextAndImages),[T,jt]=e.useState(""),[P,bt]=e.useState(""),[It,re]=e.useState(""),[ie,Lt]=e.useState(Fe.TextAndImageEmbeddings),[ue,Et]=e.useState(!1),[ce,Ut]=e.useState(!1),[Bt,le]=e.useState(!1),[Qt,ge]=e.useState(!1),[Vt,pe]=e.useState(!1),[Ft,me]=e.useState(!1),[Nt,Se]=e.useState(!1),[Gt,de]=e.useState(!1),[he,we]=e.useState(!1),[Mt,_e]=e.useState(!1),[fe,ke]=e.useState(!1),[Ce,ve]=e.useState(!1),xe=e.useRef(new Audio).current,[ye,Re]=e.useState(!1),[qt,Ae]=e.useState(!1),[Te,Pe]=e.useState(!1),h=e.useRef(""),[w,O]=e.useState(!1),[p,j]=e.useState(),[n,Oe]=e.useState(),[je,b]=e.useState([]),be={speechUrls:je,setSpeechUrls:b,audio:xe,isPlaying:ye,setIsPlaying:Re},[I,L]=e.useState(),[m,i]=e.useState(void 0),E=Ne?Be().instance:void 0;e.useContext(Ge);const[_,U]=e.useState(null),f=e.useRef(null),Ie=async()=>{Ke().then(t=>{le(t.showGPT4VOptions),Z(t.showSemanticRankerOption),ge(t.showSemanticRankerOption),se(t.showQueryRewritingOption),pe(t.showQueryRewritingOption),me(t.showReasoningEffortOption),t.showReasoningEffortOption&&ae(t.defaultReasoningEffort),Se(t.showVectorOption),t.showVectorOption||D(N.Text),de(t.showUserUpload),we(t.showLanguagePicker),_e(t.showSpeechInput),ke(t.showSpeechOutputBrowser),ve(t.showSpeechOutputAzure),Ae(t.showAgenticRetrievalOption),Pe(t.showAgenticRetrievalOption),t.showAgenticRetrievalOption&&J(10)})};e.useEffect(()=>{Ie()},[]);const k=async t=>{h.current=t,p&&j(void 0),O(!0),L(void 0),i(void 0);const F=E?await Je(E):void 0;try{const v={messages:[{content:t,role:"user"}],context:{overrides:{prompt_template:l.length===0?void 0:l,prompt_template_prefix:g.length===0?void 0:g,prompt_template_suffix:o.length===0?void 0:o,include_category:T.length===0?void 0:T,exclude_category:P.length===0?void 0:P,top:K,max_subqueries:W,results_merge_strategy:X,temperature:q,minimum_reranker_score:H,minimum_search_score:z,retrieval_mode:$,semantic_ranker:Y,semantic_captions:ee,query_rewriting:te,reasoning_effort:ne,use_oid_security_filter:ue,use_groups_security_filter:ce,vector_fields:ie,use_gpt4v:d,gpt4v_input:oe,language:V.language,use_agentic_retrieval:Te,...A!==null?{seed:A}:{}}},session_state:n?n.session_state:null},Ue=await We(v,F);Oe(Ue),b([null])}catch(v){j(v)}finally{O(!1)}},B=t=>{k(t),re(t)},Le=t=>{I===t&&m===S.CitationTab?i(void 0):(L(t),i(S.CitationTab))},C=t=>{i(m===t?void 0:t)},{t:Q,i18n:V}=y(),Ee=t=>t?!!(t.split(`
`).length>8||f.current&&f.current.offsetHeight>400):!1;return e.useEffect(()=>{n&&n.message&&n.message.content&&setTimeout(()=>{Ee(n.message.content)&&U({answer:n})},100)},[n]),s.jsx(_t,{left:s.jsxs(s.Fragment,{children:[s.jsx(Me,{className:u.settingsButton,onClick:()=>a(!0)}),s.jsx(G,{onExampleClicked:B,useGPT4V:d}),s.jsx(qe,{placeholder:Q("placeholders.askQuestion"),disabled:w,onSend:t=>k(t)})]}),right:s.jsxs("div",{style:{width:"100%"},children:[w&&s.jsx(et,{label:Q("generatingAnswer")}),!h.current&&s.jsxs("div",{className:u.askTopSection,children:[he&&s.jsx(St,{onLanguageChange:t=>V.changeLanguage(t)}),s.jsx(G,{onExampleClicked:B,useGPT4V:d})]}),!w&&n&&!p&&!_&&s.jsx("div",{className:u.askAnswerContainer,ref:f,children:s.jsx(He,{answer:n,index:0,speechConfig:be,isStreaming:!1,onCitationClicked:t=>Le(t),onThoughtProcessClicked:()=>C(S.ThoughtProcessTab),onSupportingContentClicked:()=>C(S.SupportingContentTab),showSpeechOutputAzure:Ce,showSpeechOutputBrowser:fe})}),_&&s.jsx(ze,{answer:_.answer.message.content,onClose:()=>U(null),backToHome:!0}),p?s.jsx("div",{className:u.askAnswerContainer,children:s.jsx($e,{error:p.toString(),onRetry:()=>k(h.current)})}):null,m&&n&&s.jsx(De,{className:u.askAnalysisPanel,activeCitation:I,onActiveTabChanged:t=>C(t),citationHeight:"600px",answer:n,activeTab:m})]})})}ft.displayName="Ask";export{ft as Component};
//# sourceMappingURL=Ask-BCHc7lMs.js.map
